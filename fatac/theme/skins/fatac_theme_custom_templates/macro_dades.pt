<metal:dada metal:define-macro="dadaObjecte" i18n:domain="fatac.theme">
    <tal:def tal:define="nom dada/nom; tipus dada/tipus; valor dada/valor" tal:condition="valor">

        <tal:co tal:condition="python: tipus == 'text'">
            <tal:co tal:condition="nom"><span class="etiqueta" tal:content="nom" i18n:translate=""/>: </tal:co>
            <span class="valor" tal:content="structure valor" />
        </tal:co>

        <tal:co tal:condition="python: tipus == 'forbidden'">
            <img tal:attributes="src string:${here/portal_url}/forbidden/image">
        </tal:co>

        <tal:co tal:condition="python: tipus == 'search'">
            <input type="hidden" id="string_cerca" tal:attributes="value valor" />
            <input type="hidden" id="titol_visualitzacio" tal:attributes="value dades_objecte/titol_zona_resultats" />
            <script type="text/javascript">
                $(document).ready(function() {
                    var querystring = {rows: 999999, s: '', conf:'Explorar', f: $('#string_cerca').attr('value').split(',')}
                    var parametres_visualitzacio = {querystring: querystring, visualitzacio: 'imatge', zoom: '3', pagina_actual: 1, resultats_per_pagina: 32};
                    parametres_visualitzacio['querystring']['categories'] = 'categories=class,Year,Country,Translation,License,Role,Person,Organisation,Events,Publications,ArtWork,Collection,Category';
                    //('#visual-portal-wrapper').get(0) = objecte dom sense envolcall jquery
                    $('#visual-portal-wrapper').get(0).parametres_visualitzacio = parametres_visualitzacio;
                    var parametres_visualitzacio_json = JSON.stringify(parametres_visualitzacio);
                    $.post('filtresView', {parametres_visualitzacio: parametres_visualitzacio_json}, function(data){
                        $('div#zona_filtres').replaceWith(data);
                    });
                    $.post('resultatsView', {parametres_visualitzacio: parametres_visualitzacio_json}, function(data){
                        $('div#zona_resultats').replaceWith(data);
                        $('#visualitzacio_cerca').html($('#titol_visualitzacio').attr('value'));
                    });
                });
            </script>
            <div id="zona_filtres" class="zona_filtres_inicial"><img src="spinner.gif" /></div>
            <div class="visualClear"><!--  --></div>
            <div id="zona_resultats" class="zona_resultats_inicial"><img src="spinner.gif" /></div>
        </tal:co>

        <tal:co tal:condition="python: tipus == 'linkedObjects'">
            <tal:co tal:condition="nom"><span class="etiqueta" tal:content="nom" i18n:translate=""/>: </tal:co>
            <tal:rep tal:repeat="obj valor">
                <a class="linked_object" tal:attributes="href obj/link"><span tal:content="obj/text" /></a>
                <tal:repl tal:condition="not: repeat/obj/end" tal:replace="string:, " />
            </tal:rep>
        </tal:co>

        <tal:co tal:condition="python: tipus == 'objects'">
            <input type="hidden" class="nom_dada" id="nom_dada" tal:attributes="value nom" i18n:translate=""/>
            <input type="hidden" tal:attributes="id string:llista_ids_${nom}; value valor" />
            <div tal:attributes="id string:scrollable_${nom}">
                <tal:co tal:condition="nom"><span class="arial13c999999" tal:content="nom" /></tal:co>
                <div class="requadre_objects">
                    <a class="arrow_left prev browse left">
                        <img class="arrow_up" src="++resource++fatac.theme.images/arrow_up_search.png" />
                    </a>
                    <div class="visualClear"><!--  --></div>
                    <div tal:attributes="class string:scrollable_${nom} scrollable_fatac scrollable_genericview">
                        <div tal:attributes="class string:items_${nom} items_fatac" class="">
                            <img class="spinner_home" src="spinner.gif" />
                        </div>
                    </div>
                    <div class="visualClear"><!--  --></div>
                    <a class="arrow_right next browse right">
                        <img class="arrow_down" src="++resource++fatac.theme.images/arrow_down_search.png" />
                    </a>
                </div>
            </div>
        </tal:co>

        <tal:co tal:condition="python: tipus == 'counter'">
            <div class="counters" tal:condition="valor">
                <tal:rep tal:repeat="classe valor">
                    <div class="counter" class="arial11c666666">
                        <img tal:attributes="src classe/icon; alt classe/classe" /> <span tal:content="classe/num" />
                    </div>
                </tal:rep>
            </div>
            <div class="visualClear"><!--  --></div>
        </tal:co>

        <tal:co tal:condition="python: tipus == 'media'">
            <div class="media">
            <tal:def tal:define="global hasVideo python:0"></tal:def>
            <tal:rep tal:repeat="media valor">
                <tal:def tal:define="url media/url; tipus_media media/tipus_media; profile media/profile; identificador python:url.split('/')[-1]; info_srt media/info_srt">
                    <tal:co tal:condition="python: tipus_media == 'image'">
                        <div class="photo-container">
                            <img class="media_image" tal:attributes="src url; alt identificador" />
                        </div>
                    </tal:co>

                    <tal:co tal:condition="python: tipus_media == 'video'">
                    	<tal:co tal:condition="python: hasVideo == 0" tal:define="nom dada/valor;">
                            <video class="videoTag video-js vjs-default-skin" tal:attributes="src url; id python:nom[0]['url']"
                                   width="100%" height="100%" controls="controls" data-setup='{"autoplay": false, "preload": "auto"}'>
                                <tal:co repeat="srt info_srt" condition="info_srt">
                                    <track tal:attributes="src srt/src; label srt/label" kind="captions"/>
                                </tal:co>
                            </video>
                            <br/>
	                       	|
	                    </tal:co>
                        <a href="javascript:void(0);" tal:content="profile"
                           tal:attributes="onclick string:setMediaSrc(this,'${url}', 'video')"></a> |
	                    <tal:def tal:define="global hasVideo python:1"></tal:def>
                    </tal:co>

                    <tal:co tal:condition="python: tipus_media == 'audio'">
                        <tal:co tal:condition="python: hasVideo == 0" tal:define="nom dada/valor;">
                            <video class="audioTag video-js vjs-default-skin" tal:attributes="src url; id python:nom[0]['url']"
                                   width="100%" height="100%" controls="controls" data-setup='{"autoplay": false, "preload": "auto"}'>
                                <tal:co repeat="srt info_srt" condition="info_srt">
                                    <track tal:attributes="src srt/src; label srt/label" kind="captions"/>
                                </tal:co>
                            </video>
                            <br/>
                            |
	                    </tal:co>
                        <a href="javascript:void(0);" tal:content="profile"
                           tal:attributes="onclick string:setMediaSrc(this,'${url}', 'audio')"></a> |
	                    <tal:def tal:define="global hasVideo python:1"></tal:def>
                    </tal:co>
                    <tal:co tal:condition="python: tipus_media == 'object'">
                        <tal:co tal:condition="python: url[-4:] == '.pdf'">
                            <iframe tal:attributes="src string:http://docs.google.com/gview?url=${url}&embedded=true" style="width:100%; height:90%;" frameborder="0"></iframe>
                        </tal:co>
                    </tal:co>
                </tal:def>
            </tal:rep>
            <tal:b tal:define="dades dada/valor;
                               isAnon context/@@plone_portal_state/anonymous"
                    tal:condition="python:dades[0]['showComments'] and not isAnon">
                    <a id="addSubtitles" i18n:translate="addCaptions" href="createObject?type_name=File">Afegir subtítols </a>|
                    <a id="removeSubtitles" i18n:translate="delCaptions" href="folder_contents">Esborrar subtítols</a>
            </tal:b>
            </div>
        </tal:co>
    </tal:def>
</metal:dada>
