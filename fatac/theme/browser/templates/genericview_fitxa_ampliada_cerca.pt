<!--
crida demo1: http://localhost:8084/fatac/genericView?idobjecte=Angela_RicciLucchi&visualitzacio=fitxa_ampliada_cerca
crida demo2: tb es pot cridar amb parametres_visualitzacio
-->

<!-- TODO: aquesta és en realitat genericview.pt: copiar això a genericview.pt i aquest adaptar-lo pels resultats de la cerca -->

<!-- TODO: esborrar aquest troç ............................................................................ -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master">
    <body>
        <metal:content-title fill-slot="content-title"></metal:content-title>
        <metal:content-description fill-slot="content-description"></metal:content-description>
        <metal:content-core fill-slot="content-core">
            <metal:main-macro define-macro="content">
                <div id="content" i18n:domain="fatac.theme">
<!-- /TODO: esborrar aquest troç ............................................................................. -->


<!-- TODO: he carregat el js a jsregistry.xml de forma global, potser cal afegir ocndicions xq no carreguin sempre ¿? -->
<!-- TODO: fer la crida on toqui! -->
<script type="text/javascript">
    $(document).ready(function() {
        crea_scrolls_verticals();
        inicialitza_arrows();
    });
</script>

<tal:rep tal:repeat="dades_objecte view/dades_genericview_all_sections">

    <div class="div_dotted_line_doble_negre">
        <span class="arial13c000000upp" i18n:translate="" tal:content="dades_objecte/classe" />
        <span class="arial13c000000upp">&nbsp;&nbsp;&gt;&nbsp;&nbsp;</span>
        <span class="arial13c999999upp" i18n:translate="" tal:content="dades_objecte/titol" />
    </div>

    <div class="div_dotted_line_bottom">
        <!-- arrow_desplegable: cal que tingui la classe arrow_desplegable que indica que plega o desplega un div, arrow_top o arrow_bottom que indica si plega o desplega, i una tercera classe que indica l'id dle div que plega o desplega, també indicat a rel -->
        <img rel="header_i_body_horitzontals" class="arrow_top header_i_body_horitzontals" src="++resource++fatac.theme.images/ico_arrow_up.png" />
        <img rel="header_i_body_horitzontals" class="arrow_bottom header_i_body_horitzontals hidden" src="++resource++fatac.theme.images/ico_arrow_down.png" />
        <span class="arial13c000000" tal:define="literal string:fitxa_${dades_objecte/classe}" i18n:translate="" tal:content="literal" />
    </div>

    <div class="genericview_fitxa_ampliada_cerca" tal:condition="dades_objecte"
         tal:attributes="id dades_objecte/id" tal:define="te_subcerca dades_objecte/te_subcerca" >

        <tal:co tal:condition="dades_objecte/te_subcerca" tal:replace="structure string:<div id='header_i_body_horitzontals'>" />
        <tal:co tal:condition="not: dades_objecte/te_subcerca" tal:replace="structure string:<div id='header_i_body_verticals'>" />

        <div id="header_objecte" class="slider_vertical">
            <div class="div_interior">
                <h1 tal:content="dades_objecte/titol" /> <img class="miniatura_classe" tal:attributes="src dades_objecte/thumbnail_classe" />
                <tal:rep tal:repeat="dada dades_objecte/dades_seccions/header">
                    <tal:def tal:define="nom dada/nom; tipus dada/tipus; valor dada/valor;" tal:condition="not:repeat/dada/start">
                        <span tal:condition="valor" tal:attributes="class string:${tipus}" tal:content="structure dada/valor" /><br/>
                    </tal:def>
                </tal:rep>
            </div>
        </div>

        <div id="body_objecte" class="slider_vertical">
            <div class="div_interior">
                <tal:rep tal:repeat="dada dades_objecte/dades_seccions/body">
                    <tal:def tal:define="nom dada/nom; tipus dada/tipus; valor dada/valor;" tal:condition="valor">
                        <span tal:content="nom" i18n:translate="" />
                        <span tal:attributes="class string:${tipus}" tal:content="structure dada/valor" /><br/>
                    </tal:def>
                </tal:rep>
            </div>
        </div>

        <tal:co tal:condition="dades_objecte/te_subcerca" tal:replace="structure string:</div>" />
        <tal:co tal:condition="not: dades_objecte/te_subcerca" tal:replace="structure string:</div>" />

        <div class="visualClear"><!--  --></div>

        <div id="content_objecte">

            <tal:co tal:condition="dades_objecte/te_subcerca">

                <input type="hidden" id="string_cerca" tal:attributes="value dades_objecte/string_cerca" />
                <input type="hidden" id="titol_visualitzacio" tal:attributes="value dades_objecte/titol_zona_resultats" />

                <script type="text/javascript">
                    $(document).ready(function() {
                        var querystring = {rows: 999999, s: '', f: $('.string_cerca').attr('value')}

                        var parametres_visualitzacio = {querystring: querystring, visualitzacio: 'imatge', zoom: '1', pagina_actual: 1, resultats_per_pagina: 66};

                        //('#visual-portal-wrapper').get(0) = objecte dom sense envolcall jquery
                        $('#visual-portal-wrapper').get(0).parametres_visualitzacio = parametres_visualitzacio;

                        var parametres_visualitzacio_json = JSON.stringify(parametres_visualitzacio);

                        $.post('filtresView', {parametres_visualitzacio: parametres_visualitzacio_json}, function(data){
                            $('div#zona_filtres').replaceWith(data);
                        });

                        $.post('resultatsView', {parametres_visualitzacio: parametres_visualitzacio_json}, function(data){
                            $('div#zona_resultats').replaceWith(data);
                            $('#visualitzacio_cerca').html($('#titol_visualitzacio').attr('value'));
                        });
                    });
                </script>

                <div id="zona_filtres" class="zona_filtres_inicial"><img src="spinner.gif" /></div>

                <div class="visualClear"><!--  --></div>

                <div id="zona_resultats" class="zona_resultats_inicial"><img src="spinner.gif" /></div>

            </tal:co>

            <tal:co tal:condition="not: dades_objecte/te_subcerca">
                <img src="http://3.bp.blogspot.com/-011FO05kclE/TW-YKzZeXCI/AAAAAAAAAA0/_p6pdoEjaCY/no_music.png" /><br/><br/>
                <img src="http://3.bp.blogspot.com/-011FO05kclE/TW-YKzZeXCI/AAAAAAAAAA0/_p6pdoEjaCY/no_music.png" /><br/><br/>
                <img src="http://3.bp.blogspot.com/-011FO05kclE/TW-YKzZeXCI/AAAAAAAAAA0/_p6pdoEjaCY/no_music.png" />
            </tal:co>

        </div>

        <!--
        <div id="dades_left" class="slider_vertical">
            <div class="div_interior">
                <div id="seccio_header">
                    <h1 tal:content="dades_objecte/titol" /> <img class="miniatura_classe" tal:attributes="src dades_objecte/thumbnail_classe" />
                    <tal:rep tal:repeat="dada dades_objecte/dades_seccions/header">
                        <tal:def tal:define="nom dada/nom; tipus dada/tipus; valor dada/valor;" tal:condition="not:repeat/dada/start">
                            <span tal:condition="valor" tal:attributes="class string:${tipus}" tal:content="structure dada/valor" /><br/>
                        </tal:def>
                    </tal:rep>
                </div>
                <div id="seccio_body">
                    <tal:rep tal:repeat="dada dades_objecte/dades_seccions/body">
                        <tal:def tal:define="nom dada/nom; tipus dada/tipus; valor dada/valor;" tal:condition="valor">
                            <span tal:content="nom" i18n:translate="" />
                            <span tal:attributes="class string:${tipus}" tal:content="structure dada/valor" /><br/>
                        </tal:def>
                    </tal:rep>
                </div>
            </div>
        </div>
        <div id="dades_right" class="slider_vertical">
            <div class="div_interior">
                <div id="seccio_content">
                    <img src="http://3.bp.blogspot.com/-011FO05kclE/TW-YKzZeXCI/AAAAAAAAAA0/_p6pdoEjaCY/no_music.png" /><br/><br/>
                    <img src="http://3.bp.blogspot.com/-011FO05kclE/TW-YKzZeXCI/AAAAAAAAAA0/_p6pdoEjaCY/no_music.png" /><br/><br/>
                    <img src="http://3.bp.blogspot.com/-011FO05kclE/TW-YKzZeXCI/AAAAAAAAAA0/_p6pdoEjaCY/no_music.png" />
                </div>
            </div>
        </div>
        -->
    </div>
</tal:rep>


<!--
            <tal:def tal:define="dades_json view/getView">
                <tal:rep tal:repeat="section dades_json/sections">
                    <tal:def tal:define="name section/name; data section/data">
                        <div tal:attributes="id string:generic_${name}">
                            SECCIÓ: <tal:repl tal:replace="name" /><br/>
                            <tal:rep tal:repeat="item data">
                                <tal:repl tal:replace="item" /><br/>
-->
<!-- if tipus text: name:value -->
<!-- if tipus linkedobjects (nom + valor(jordi@id))... fer link que quan cliquin sobre nom vagin a veure l'ob amb id id -->
<!-- if tipus media... -->
<!--
                            </tal:rep>
                        </div>
                    </tal:def>
                </tal:rep>
            </tal:def>
-->
<!--
            <iframe tal:condition="view/getMedia" tal:attributes="src view/getMedia" transparency>
                text alternatiu
            </iframe>
-->
            <!-- TODO: tb funciona amb object, no sé quina forma és millor
            <object tal:condition="view/getMedia" tal:attributes="data view/getMedia">
                Warning: media could not be embedded.
            </object>
            -->


<!-- TODO: esborrar aquest troç .............................................................................. -->
                </div>
            </metal:main-macro>
        </metal:content-core>
    </body>
</html>
<!-- /TODO: esborrar aquest troç ............................................................................. -->